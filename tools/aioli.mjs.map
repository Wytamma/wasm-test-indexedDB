{"version":3,"file":"aioli.mjs","sources":["../node_modules/comlink/dist/esm/comlink.mjs","../src/main.js"],"sourcesContent":["/**\r\n * Copyright 2019 Google Inc. All Rights Reserved.\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nconst proxyMarker = Symbol(\"Comlink.proxy\");\r\nconst createEndpoint = Symbol(\"Comlink.endpoint\");\r\nconst releaseProxy = Symbol(\"Comlink.releaseProxy\");\r\nconst throwMarker = Symbol(\"Comlink.thrown\");\r\nconst isObject = (val) => (typeof val === \"object\" && val !== null) || typeof val === \"function\";\r\n/**\r\n * Internal transfer handle to handle objects marked to proxy.\r\n */\r\nconst proxyTransferHandler = {\r\n    canHandle: (val) => isObject(val) && val[proxyMarker],\r\n    serialize(obj) {\r\n        const { port1, port2 } = new MessageChannel();\r\n        expose(obj, port1);\r\n        return [port2, [port2]];\r\n    },\r\n    deserialize(port) {\r\n        port.start();\r\n        return wrap(port);\r\n    },\r\n};\r\n/**\r\n * Internal transfer handler to handle thrown exceptions.\r\n */\r\nconst throwTransferHandler = {\r\n    canHandle: (value) => isObject(value) && throwMarker in value,\r\n    serialize({ value }) {\r\n        let serialized;\r\n        if (value instanceof Error) {\r\n            serialized = {\r\n                isError: true,\r\n                value: {\r\n                    message: value.message,\r\n                    name: value.name,\r\n                    stack: value.stack,\r\n                },\r\n            };\r\n        }\r\n        else {\r\n            serialized = { isError: false, value };\r\n        }\r\n        return [serialized, []];\r\n    },\r\n    deserialize(serialized) {\r\n        if (serialized.isError) {\r\n            throw Object.assign(new Error(serialized.value.message), serialized.value);\r\n        }\r\n        throw serialized.value;\r\n    },\r\n};\r\n/**\r\n * Allows customizing the serialization of certain values.\r\n */\r\nconst transferHandlers = new Map([\r\n    [\"proxy\", proxyTransferHandler],\r\n    [\"throw\", throwTransferHandler],\r\n]);\r\nfunction expose(obj, ep = self) {\r\n    ep.addEventListener(\"message\", function callback(ev) {\r\n        if (!ev || !ev.data) {\r\n            return;\r\n        }\r\n        const { id, type, path } = Object.assign({ path: [] }, ev.data);\r\n        const argumentList = (ev.data.argumentList || []).map(fromWireValue);\r\n        let returnValue;\r\n        try {\r\n            const parent = path.slice(0, -1).reduce((obj, prop) => obj[prop], obj);\r\n            const rawValue = path.reduce((obj, prop) => obj[prop], obj);\r\n            switch (type) {\r\n                case \"GET\" /* GET */:\r\n                    {\r\n                        returnValue = rawValue;\r\n                    }\r\n                    break;\r\n                case \"SET\" /* SET */:\r\n                    {\r\n                        parent[path.slice(-1)[0]] = fromWireValue(ev.data.value);\r\n                        returnValue = true;\r\n                    }\r\n                    break;\r\n                case \"APPLY\" /* APPLY */:\r\n                    {\r\n                        returnValue = rawValue.apply(parent, argumentList);\r\n                    }\r\n                    break;\r\n                case \"CONSTRUCT\" /* CONSTRUCT */:\r\n                    {\r\n                        const value = new rawValue(...argumentList);\r\n                        returnValue = proxy(value);\r\n                    }\r\n                    break;\r\n                case \"ENDPOINT\" /* ENDPOINT */:\r\n                    {\r\n                        const { port1, port2 } = new MessageChannel();\r\n                        expose(obj, port2);\r\n                        returnValue = transfer(port1, [port1]);\r\n                    }\r\n                    break;\r\n                case \"RELEASE\" /* RELEASE */:\r\n                    {\r\n                        returnValue = undefined;\r\n                    }\r\n                    break;\r\n                default:\r\n                    return;\r\n            }\r\n        }\r\n        catch (value) {\r\n            returnValue = { value, [throwMarker]: 0 };\r\n        }\r\n        Promise.resolve(returnValue)\r\n            .catch((value) => {\r\n            return { value, [throwMarker]: 0 };\r\n        })\r\n            .then((returnValue) => {\r\n            const [wireValue, transferables] = toWireValue(returnValue);\r\n            ep.postMessage(Object.assign(Object.assign({}, wireValue), { id }), transferables);\r\n            if (type === \"RELEASE\" /* RELEASE */) {\r\n                // detach and deactive after sending release response above.\r\n                ep.removeEventListener(\"message\", callback);\r\n                closeEndPoint(ep);\r\n            }\r\n        });\r\n    });\r\n    if (ep.start) {\r\n        ep.start();\r\n    }\r\n}\r\nfunction isMessagePort(endpoint) {\r\n    return endpoint.constructor.name === \"MessagePort\";\r\n}\r\nfunction closeEndPoint(endpoint) {\r\n    if (isMessagePort(endpoint))\r\n        endpoint.close();\r\n}\r\nfunction wrap(ep, target) {\r\n    return createProxy(ep, [], target);\r\n}\r\nfunction throwIfProxyReleased(isReleased) {\r\n    if (isReleased) {\r\n        throw new Error(\"Proxy has been released and is not useable\");\r\n    }\r\n}\r\nfunction createProxy(ep, path = [], target = function () { }) {\r\n    let isProxyReleased = false;\r\n    const proxy = new Proxy(target, {\r\n        get(_target, prop) {\r\n            throwIfProxyReleased(isProxyReleased);\r\n            if (prop === releaseProxy) {\r\n                return () => {\r\n                    return requestResponseMessage(ep, {\r\n                        type: \"RELEASE\" /* RELEASE */,\r\n                        path: path.map((p) => p.toString()),\r\n                    }).then(() => {\r\n                        closeEndPoint(ep);\r\n                        isProxyReleased = true;\r\n                    });\r\n                };\r\n            }\r\n            if (prop === \"then\") {\r\n                if (path.length === 0) {\r\n                    return { then: () => proxy };\r\n                }\r\n                const r = requestResponseMessage(ep, {\r\n                    type: \"GET\" /* GET */,\r\n                    path: path.map((p) => p.toString()),\r\n                }).then(fromWireValue);\r\n                return r.then.bind(r);\r\n            }\r\n            return createProxy(ep, [...path, prop]);\r\n        },\r\n        set(_target, prop, rawValue) {\r\n            throwIfProxyReleased(isProxyReleased);\r\n            // FIXME: ES6 Proxy Handler `set` methods are supposed to return a\r\n            // boolean. To show good will, we return true asynchronously ¯\\_(ツ)_/¯\r\n            const [value, transferables] = toWireValue(rawValue);\r\n            return requestResponseMessage(ep, {\r\n                type: \"SET\" /* SET */,\r\n                path: [...path, prop].map((p) => p.toString()),\r\n                value,\r\n            }, transferables).then(fromWireValue);\r\n        },\r\n        apply(_target, _thisArg, rawArgumentList) {\r\n            throwIfProxyReleased(isProxyReleased);\r\n            const last = path[path.length - 1];\r\n            if (last === createEndpoint) {\r\n                return requestResponseMessage(ep, {\r\n                    type: \"ENDPOINT\" /* ENDPOINT */,\r\n                }).then(fromWireValue);\r\n            }\r\n            // We just pretend that `bind()` didn’t happen.\r\n            if (last === \"bind\") {\r\n                return createProxy(ep, path.slice(0, -1));\r\n            }\r\n            const [argumentList, transferables] = processArguments(rawArgumentList);\r\n            return requestResponseMessage(ep, {\r\n                type: \"APPLY\" /* APPLY */,\r\n                path: path.map((p) => p.toString()),\r\n                argumentList,\r\n            }, transferables).then(fromWireValue);\r\n        },\r\n        construct(_target, rawArgumentList) {\r\n            throwIfProxyReleased(isProxyReleased);\r\n            const [argumentList, transferables] = processArguments(rawArgumentList);\r\n            return requestResponseMessage(ep, {\r\n                type: \"CONSTRUCT\" /* CONSTRUCT */,\r\n                path: path.map((p) => p.toString()),\r\n                argumentList,\r\n            }, transferables).then(fromWireValue);\r\n        },\r\n    });\r\n    return proxy;\r\n}\r\nfunction myFlat(arr) {\r\n    return Array.prototype.concat.apply([], arr);\r\n}\r\nfunction processArguments(argumentList) {\r\n    const processed = argumentList.map(toWireValue);\r\n    return [processed.map((v) => v[0]), myFlat(processed.map((v) => v[1]))];\r\n}\r\nconst transferCache = new WeakMap();\r\nfunction transfer(obj, transfers) {\r\n    transferCache.set(obj, transfers);\r\n    return obj;\r\n}\r\nfunction proxy(obj) {\r\n    return Object.assign(obj, { [proxyMarker]: true });\r\n}\r\nfunction windowEndpoint(w, context = self, targetOrigin = \"*\") {\r\n    return {\r\n        postMessage: (msg, transferables) => w.postMessage(msg, targetOrigin, transferables),\r\n        addEventListener: context.addEventListener.bind(context),\r\n        removeEventListener: context.removeEventListener.bind(context),\r\n    };\r\n}\r\nfunction toWireValue(value) {\r\n    for (const [name, handler] of transferHandlers) {\r\n        if (handler.canHandle(value)) {\r\n            const [serializedValue, transferables] = handler.serialize(value);\r\n            return [\r\n                {\r\n                    type: \"HANDLER\" /* HANDLER */,\r\n                    name,\r\n                    value: serializedValue,\r\n                },\r\n                transferables,\r\n            ];\r\n        }\r\n    }\r\n    return [\r\n        {\r\n            type: \"RAW\" /* RAW */,\r\n            value,\r\n        },\r\n        transferCache.get(value) || [],\r\n    ];\r\n}\r\nfunction fromWireValue(value) {\r\n    switch (value.type) {\r\n        case \"HANDLER\" /* HANDLER */:\r\n            return transferHandlers.get(value.name).deserialize(value.value);\r\n        case \"RAW\" /* RAW */:\r\n            return value.value;\r\n    }\r\n}\r\nfunction requestResponseMessage(ep, msg, transfers) {\r\n    return new Promise((resolve) => {\r\n        const id = generateUUID();\r\n        ep.addEventListener(\"message\", function l(ev) {\r\n            if (!ev.data || !ev.data.id || ev.data.id !== id) {\r\n                return;\r\n            }\r\n            ep.removeEventListener(\"message\", l);\r\n            resolve(ev.data);\r\n        });\r\n        if (ep.start) {\r\n            ep.start();\r\n        }\r\n        ep.postMessage(Object.assign({ id }, msg), transfers);\r\n    });\r\n}\r\nfunction generateUUID() {\r\n    return new Array(4)\r\n        .fill(0)\r\n        .map(() => Math.floor(Math.random() * Number.MAX_SAFE_INTEGER).toString(16))\r\n        .join(\"-\");\r\n}\n\nexport { createEndpoint, expose, proxy, proxyMarker, releaseProxy, transfer, transferHandlers, windowEndpoint, wrap };\n//# sourceMappingURL=comlink.mjs.map\n","import { wrap } from \"comlink\";\nimport AioliWorker from \"./worker?worker&inline\";\n\n// Constants\nconst URL_CDN_ROOT = \"https://biowasm.com/cdn/v3\";\nconst URL_CDN_ROOT_STG = \"https://stg.biowasm.com/cdn/v3\";\nconst CONFIG_DEFAULTS = {\n\t// Biowasm CDN URLs\n\turlCDN: URL_CDN_ROOT,\n\turlCDNStg: URL_CDN_ROOT_STG,\n\n\t// Folder to use for mounting the shared filesystem\n\tdirShared: \"/shared\",\n\t// Folder to use for mounting File/Blob objects to the virtual file system\n\tdirMounted: \"/mnt\",\n\t// Folder to use for symlinks (basically, we make a symlink to each file mounted on WORKERFS\n\t// so that operations like \"samtools index\" don't crash due to the read-only nature of WORKERS).\n\t// Also mount URLs lazily in that folder.\n\tdirData: \"/data\",\n\t// Interleave stdout/stderr. If set to false, `.exec()` returns an object { \"stdout\": <text>, \"stderr\": <text> }\n\tprintInterleaved: true,\n\t// Stream stdout/stderr continuously to the main thread, instead of waiting for the WebWorker to finish running a command.\n\tprintStream: false,\n\n\t// Callback function to run whenever we receive a message from the WebWorker with payload { type: \"biowasm\", value: ... }.\n\t// See <https://github.com/biowasm/biowasm/tree/main/tools/bhtsne> for an example of how this can be used to send regular updates\n\t// back to the main thread before callMain() is done running.\n\tcallback: null,\n\n\t// Debugging\n\tdebug: false,\n\tenv: \"prd\"\n};\n\n// Class: 1 object = 1 worker; user can decide if they want tools running in separate threads or all of them in one\nexport default class Aioli {\n\tconstructor(tools, config={}) {\n\t\tif(tools == null)\n\t\t\tthrow \"Expecting array of tools as input to Aioli constructor.\";\n\n\t\t// Parse user input\n\t\tif(!Array.isArray(tools))\n\t\t\ttools = [ tools ];\n\t\t// Overwrite default config if specified\n\t\tconfig = Object.assign({}, CONFIG_DEFAULTS, config);\n\t\t// For convenience, support \"<tool>/<version>\" or \"<tool>/<program>/<version>\" instead of object config\n\t\ttools = tools.map(this._parseTool);\n\t\t// If testing with different environment e.g. stg.biowasm.com\n\t\tif(config.env === \"stg\")\n\t\t\tconfig.urlCDN = config.urlCDNStg;\n\n\t\t// Set state\n\t\tthis.tools = tools;\n\t\tthis.config = config;\n\n\t\t// Handle callback (delete it because we can't send a function to the WebWorker)\n\t\tif(this.config.callback != null)\n\t\t\tthis.callback = this.config.callback;\n\t\tdelete this.config.callback;\n\n\t\treturn this.init();\n\t}\n\n\t// Initialize the WebWorker and the WebAssembly modules within it\n\tasync init() {\n\t\t// Create the WebWorker\n\t\tconst worker = new AioliWorker();\n\n\t\t// Listen for \"biowasm\" messages from the WebWorker\n\t\tif(this.callback)\n\t\t\tworker.onmessage = e => {\n\t\t\t\tif(e.data.type === \"biowasm\")\n\t\t\t\t\tthis.callback(e.data.value);\n\t\t\t}\n\n\t\tconst aioli = wrap(worker);\n\t\taioli.tools = this.tools;\n\t\taioli.config = this.config;\n\n\t\t// Initialize the tools inside the WebWorker\n\t\tawait aioli.init();\n\n\t\treturn aioli;\n\t}\n\n\t// Parse \"<tool>/<version>\" and \"<tool>/<program>/<version>\" into { \"tool\": <tool>, \"program\": <program>, \"version\": <version> }\n\t_parseTool(tool) {\n\t\t// If not a string, leave it as is\n\t\tif(typeof tool !== \"string\")\n\t\t\treturn tool;\n\n\t\t// Support \"<tool>/<version>\" and \"<tool>/<program>/<version>\"\n\t\tconst toolSplit = tool.split(\"/\");\n\t\tif(toolSplit.length != 2 && toolSplit.length != 3)\n\t\t\tthrow \"Expecting '<tool>/<version>' or '<tool>/<program>/<version>'\";\n\n\t\treturn {\n\t\t\ttool: toolSplit[0],\n\t\t\tprogram: toolSplit.length == 3 ? toolSplit[1] : toolSplit[0],\n\t\t\tversion: toolSplit[toolSplit.length - 1]\n\t\t};\n\t}\n}\n"],"names":["obj","returnValue","proxy","AioliWorker"],"mappings":"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"}